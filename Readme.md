# FastAPI Project

## Описание

Этот проект представляет собой RESTful API, построенный с использованием FastAPI и SQLAlchemy для управления пользователями, ролями и услугами. API поддерживает аутентификацию пользователей и управление правами доступа.

## Установка

Следуйте этим шагам, чтобы установить проект на вашем локальном компьютере:

1. **Клонируйте репозиторий:**

   ```bash
   git clone https://github.com/malkovila/VSporte_task.git
   cd VSporte_task

2. **Создайте и активируйте виртуальное окружение:**
      ```bash
    python -m venv venv
    source venv/bin/activate
   
3. **Установите зависимости:**
      ```bash
    pip install -r requirements.txt
 
4. **Создайте файл .env:**
DATABASE_USERNAME=your_name

DATABASE_PASSWORD=your_password

DATABASE_HOST=your_host

DATABASE_PORT=your_port

DATABASE_NAME=your_name

SECRET_KEY=your_key

ALGORITHM=HS256

ACCESS_TOKEN_EXPIRE_MINUTES=30

5. **Проведение миграции:**
      ```bash
    alembic init alembic
В файле alembic.ini обновите строку подключения к вашей базе данных:

sqlalchemy.url = driver://DATABASE_USERNAME:DATABASE_PASSWORD@DATABASE_HOST/DATABASE_NAME

Создайте первую миграцию:

alembic revision --autogenerate -m "Initial migration"

Примените миграцию:

alembic upgrade head

6. **Сборка и запуск контейнера**
      ```bash
    docker-compose up --build

7. **Использование приложения**
Все API можно посмотреть по адресу: http://127.0.0.1:8000/docs#
.../create_user - создание(регистрация пользователя)
.../token - получение токена доступа
.../create_role - добавление роли (например, создание user или admin роли)
.../get_role_to_user - назначение зарег. пользователю роли на выбранном сервисе(может делать только админ)
.../delete_user - удаление пользователя с выбранного сервиса (может делать только админ)
.../users - получение списка пользователей на сервисе (может делать только админ)
...//delete_user - удаление аккаунта пользователем, которому аккаунт пренадлежит

8. **Все запросы защищены посредствам JWT авторизации**
Шаги для аутентификации и использования токена в Swagger UI
Получение токена:

Перейдите в Swagger UI вашего приложения (обычно по адресу /docs).
Найдите маршрут POST /token (или как он у вас называется) и выполните его, передав необходимые данные (имя пользователя и пароль) в форме.
После успешного выполнения вы получите ответ с access_token.

Авторизация в Swagger UI:

В верхней части страницы Swagger UI вы увидите кнопку Authorize (обычно в виде иконки замка).
Нажмите на Authorize, и откроется диалоговое окно для ввода токена.
В поле ввода вставьте полученный access_token, предварительно добавив префикс Bearer . Например:
Копировать код
Bearer eyJhbGciOiJIUzI1NiIsInR5cCI6...
Нажмите Authorize, чтобы сохранить токен для последующих запросов.
Использование защищённых маршрутов:

После успешной авторизации все ваши последующие запросы через Swagger UI автоматически будут включать заголовок Authorization с вашим JWT-токеном.
Теперь вы можете выполнять защищённые маршруты, такие как GET /users/, без необходимости вручную добавлять токен в каждый запрос.


9. **После того как зарегистрируете первого пользователя, два раза вызовите роут .../create_role с аргументами admin и user**


10. **Дальше пользуйтесь приложением!**


